#' Plot the synthetic household populations on a map
#' @param region_name character name of the region for use in finding with ggmap
#' @param hh_pop the synthetic population generated by spew for a given region
#' @param region_shape shapefile of the region ONLY
#' @param z zoom for ggmap 10 is far in, 1 is far out
#' @param title_map - title for the map
#' @return plot of the region, a ggmap object

plot_pop <- function(region_name, hh_pop, region_shape, zoom=8, title_map=region_name){
    #fortify the shape for ggplot
    shape.fort <- fortify(region_shape)
    # get the centers for labeling
    center.df <- as.data.frame(coordinates(region_shape))
    names(center.df) <- c("Longitude", "Latitude")
    center.df$region <- region_name
    print(center.df)
    #get hte map
    google.map <- get_map(c(center.df$Longitude, center.df$Latitude), zoom=zoom, maptype="roadmap")
    stopifnot(sum(c("latitude", "longitude") %in% names(hh_pop)) == 2)
    df.coords <- subset(hh_pop, select=c("latitude","longitude"))
    #making the actual map
    g <- ggmap(google.map) +
    geom_polygon(aes(x = long, y = lat, group = group), data=shape.fort,
               colour = "darkgreen", fill = NA, alpha = .4, size = 2, cex=3) +
    geom_point(aes(x=longitude, y=latitude), data=df.coords, color="blue", size=.5) +
    geom_text(aes(label = region, x = Longitude, y = Latitude), data=center.df, 
            cex=6, font=3) +
    theme_nothing(legend=TRUE) +
    ggtitle(title_map)
    print(g)
    return(g)
}
